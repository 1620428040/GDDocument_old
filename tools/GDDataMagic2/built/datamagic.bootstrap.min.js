Function["abstract"]=function(){DataMagic.debug("abstract function")};Function.empty=function(){};Object.create||(Object.create=function(a){Function.empty.prototype=a;return new Function.empty});var Class=function(){};Class.inherit=function(a,b,c,d){var e=this;b="function"===typeof b?b:function(){e.apply(this,arguments)};b.prototype=Object.create(e.prototype);for(var f in e)b[f]=e[f];if(c)for(f in c)b[f]=c[f];if(d)for(f in d)b.prototype[f]=d[f];b.prototype.constructor=b;b.classTitle=a;b.base=e;return b};Class.extend=function(a,b){return this.inherit(a.title,a.construct,b,a)};Class.classTitle="\u57fa\u7840\u7c7b";Class.toString=function(){return this.base&&null==this.classTitle?this.base.toString()+" \u7684\u5b50\u7c7b":this.classTitle};Class.prototype.toString=function(){return this.getClass().toString()+" \u7684\u5b9e\u4f8b"};Class.prototype.getClass=function(){return Object.getPrototypeOf?Object.getPrototypeOf(this).constructor:"\u5f53\u524d\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u83b7\u53d6\u539f\u578b"};Date.prototype.format=function(a){var b={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":0==this.getHours()%12?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()},c={0:"/u65e5",1:"/u4e00",2:"/u4e8c",3:"/u4e09",4:"/u56db",5:"/u4e94",6:"/u516d"};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));/(E+)/.test(a)&&(a=a.replace(RegExp.$1,(1<RegExp.$1.length?2<RegExp.$1.length?"/u661f/u671f":"/u5468":"")+c[this.getDay()+""]));for(var d in b)(new RegExp("("+d+")")).test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?b[d]:("00"+b[d]).substr((""+b[d]).length)));return a};Date.createFormFormatString=function(a,b){var c="yMdHhmsS".split(""),d=[],e=new Date(0),f;for(f in c){var g=c[f];(new RegExp("("+g+"+)")).test(a)&&d.push({sign:g,length:RegExp.$1.length,index:a.indexOf(RegExp.$1)})}d.sort(function(a,b){return a.index-b.index});c=b.match(RegExp("([0-9]{1,4})","g"));for(f in d){var g=d[f],h=c[f];"y"===g.sign?e.setYear(parseInt("2000".substr(0,4-g.length)+h)):"M"===g.sign?e.setMonth(parseInt(h)-1):"d"===g.sign?e.setDate(parseInt(h)):"H"===g.sign?e.setHours(parseInt(h)):"h"===g.sign?e.setHours(parseInt(h)):"m"===g.sign?e.setMinutes(parseInt(h)):"s"===g.sign?e.setSeconds(parseInt(h)):"S"===g.sign&&e.setMilliseconds(parseInt(h))}return e};Date.changeFormat=function(a,b,c){return Date.createFormFormatString(a,c).format(b)};var DataMagic={Model:null,Controller:null,View:{},DataType:{},Field:{},initViewWithMeta:function(a){},debug:function(a){},dialog:function(a){alert(a)},alert:function(a){alert(a)},ajaxSend:function(a){},ajaxStop:function(){}},DMAbstractView={title:"\u62bd\u8c61\u89c6\u56fe",construct:function(a){this.controller=a},initView:Function["abstract"],clearAll:Function["abstract"],append:Function["abstract"],show:Function["abstract"],hide:Function["abstract"]};DataMagic.View.Abstract=Class.extend(DMAbstractView);var DMAbstractField={title:"\u8f93\u5165\u6846\u7684\u62bd\u8c61\u7c7b",construct:function(a){this.dataType=a},setValue:Function["abstract"],getValue:Function["abstract"],createField:function(a,b,c){},createSearchField:function(a,b,c){this.createField(a,b,c)},showMistake:Function["abstract"],hideMistake:Function["abstract"],onInputClick:function(a){}};DataMagic.Field.Abstract=DataMagic.View.Abstract.extend(DMAbstractField);var DMBaseDataType={title:"\u57fa\u7840\u6570\u636e\u7c7b\u578b",construct:function(a,b){this.fieldName=a;this.fieldMeta=b;var c=b.regexp||this.defaultRegExp;c&&(this.regexp=new RegExp(c))},inputField:DataMagic.Field.Abstract,tranToString:function(a){return null==a||""===a?"":a.toString()},tranToData:function(a){return a},typeValidation:function(a){return this.pattern?this.pattern.test(a):!0},createInputField:function(a){null==this.field&&(this.field=new this.inputField(this));this.field.createField(this.fieldName,this.fieldMeta,a);return this.field},validationValue:function(a,b){var c=!0;c&&null===a&&(c=this.fieldMeta.notNull?!1:!0);c&&this.regexp&&(c=this.regexp.test(a));(c=c&&this.typeValidation(a))?this.field.hideMistake(b):this.field.showMistake(b);DataMagic.debug("\u7c7b\u578b\u68c0\u67e5  value:"+a+"  validated:"+c);return c},getValue:function(){var a=this.field.getValue(this.field.input);this.validated=this.validationValue(a,this.field.input);return this.tranToData(a)},createSearchField:function(){null==this.field&&(this.field=new this.inputField(this));this.field.createSearchField(this.fieldName,this.fieldMeta,null);return this.field},validationSearchParams:function(a,b){var c=null===a?!0:this.typeValidation(a);c?this.field.hideMistake(b):this.field.showMistake(b);return c},getSearchParams:function(){var a=this.field.getValue(this.field.input);this.validated=this.validationSearchParams(a,this.field.input);return this.tranToData(a)}};DataMagic.DataType.Base=Class.extend(DMBaseDataType);DataMagic.DataType.LongText=DataMagic.DataType.Base.inherit("\u957f\u6587\u672c\u6570\u636e\u7c7b\u578b");var DMNumberDataType={title:"\u6570\u5b57\u6570\u636e\u7c7b\u578b",pattern:/^[0-9]{0,}$/,tranToData:function(a){return null==a?null:parseInt(a)},getSearchParams:function(){var a={},b=this.field.getValue(this.field.minInput),c=this.validationSearchParams(b,this.field.minInput);a.start=this.tranToData(b);var b=this.field.getValue(this.field.maxInput),d=this.validationSearchParams(b,this.field.maxInput);a.end=this.tranToData(b);this.validated=c&&d;return null===a.start&&null===a.end?null:a}};DataMagic.DataType.Number=DataMagic.DataType.Base.extend(DMNumberDataType);var DMDateDataType={title:"\u65e5\u671f\u6570\u636e\u7c7b\u578b",format:"yyyy\u5e74M\u6708d\u65e5",pattern:/^[0-9]{4}\u5e74[0-9]{1,2}\u6708[0-9]{1,2}\u65e5$/,tranToString:function(a){if(null==a||""===a)return"";"string"===typeof a&&(a=parseInt(a));return(new Date(1E3*a)).format(this.format)},tranToData:function(a){return null===a?null:Date.createFormFormatString(this.format,a).getTime()/1E3}};DataMagic.DataType.Date=DataMagic.DataType.Number.extend(DMDateDataType);var DMDateTimeDataType={title:"\u65e5\u671f\u52a0\u65f6\u95f4\u6570\u636e\u7c7b\u578b",format:"yyyy\u5e74M\u6708d\u65e5  H\u65f6m\u5206",pattern:/^[0-9]{4}\u5e74[0-9]{1,2}\u6708[0-9]{1,2}\u65e5  [0-9]{1,2}\u65f6[0-9]{1,2}\u5206$/};DataMagic.DataType.DateTime=DataMagic.DataType.Date.extend(DMDateTimeDataType);var DMSelectDataType={title:"\u5355\u9009\u6570\u636e\u7c7b\u578b",construct:function(a,b){DataMagic.DataType.Base.apply(this,arguments);this.options={};this.any="\u4efb\u610f";var c=[],d=b.valueRange.split(";"),e;for(e in d){var f=d[e].split(",");this.options[f[0]]=f[1];c.push(f[1])}this.pattern=new RegExp("^(?:"+c.join("|")+"|"+this.any+")$")},typeValidation:function(a){return this.pattern.test(a)},tranToString:function(a){return this.options[a]||""},tranToData:function(a){for(var b in this.options)if(this.options[b]===a)return b}};DataMagic.DataType.Select=DataMagic.DataType.Base.extend(DMSelectDataType);var DMMultipleDataType={title:"\u591a\u9009\u6570\u636e\u7c7b\u578b",typeValidation:function(a){a=a.split(",");for(var b in a)if(!this.pattern.test(a[b]))return!1;return!0},tranToString:function(a){var b=[],c=a.split(","),d;for(d in c)b.push(this.options[a]);return 0<b.length?b.join(","):null},tranToData:function(a){a=a.split(",");var b=[],c;for(c in a)for(var d in this.options)a[c]&&b.push(d);return 0<b.length?b.join(","):null}};DataMagic.DataType.Multiple=DataMagic.DataType.Select.extend(DMMultipleDataType);var DMBoolDataType={title:"\u5e03\u5c14\u6570\u636e\u7c7b\u578b",construct:function(a,b){DataMagic.DataType.Base.call(this,a,b);this.options={1:"\u662f",0:"\u5426"};this.any="\u4efb\u610f"},typeValidation:function(a){return a===this.any?!0:/^[\u662f\u5426]$/.test(a)},tranToString:function(a){return null==a?null:"1"===a?"\u662f":"\u5426"},tranToData:function(a){var b=null;"\u662f"===a?b="1":"\u5426"===a&&(b="0");return b}};DataMagic.DataType.Bool=DataMagic.DataType.Select.extend(DMBoolDataType);var DMListModel={title:"\u57fa\u7840model",construct:function(a,b,c,d,e){this.name=a;this.storage=b;this.server={};c&&(this.host=c);this.controller=d;e?(this.pagesize=e.pagesize||20,this.page=e.page||0,this.lastFilter=this.filter=e.filter||null,e.pagesize||e.page||e.filter||(this.filter=e)):(this.pagesize=20,this.page=0);(c||this.server.getMeta)&&this.downloadMeta()},getServerUrl:function(a){if(this.server[a])return this.server[a];if(this.host){var b=this.host,c=0>b.indexOf("?")?"?":"\x26";return b+c+"name\x3d"+this.name+"\x26action\x3d"+a}DataMagic.debug("\u9700\u8981\u6307\u5b9a\u670d\u52a1\u5668\u5730\u5740\u6216\u8005\u63d0\u4f9bmeta")},downloadMeta:function(a){var b=this;DataMagic.Model.request(this.getServerUrl("getMeta"),{where:this.filter,pagesize:this.pagesize,page:this.page},function(c){b.initWithMeta(c);a&&a.call(this)})},initWithMeta:function(a){this.meta=a;for(var b in this.meta.fieldList){var c=this.meta.fieldList[b];c.dataType=new (DataMagic.DataType[c.type||"Base"]||DataMagic.DataType.Base)(b,c)}this.controller.onMetaLoad();if(a.data)this.data=this.changeDataIndex(a.data),this.controller.onDataLoad();else if(this.host||this.server.search){var d=this;this.search(function(){d.controller.onDataLoad()})}},changeDataIndex:function(a){var b=[],c;for(c in a)b[a[c].id]=a[c];return b},request:function(a,b,c){DataMagic.Model.request(a,b,function(a){c(a)})},save:function(){this.storage&&(this.storage.setItem(this.name+"_meta",JSON.stringify(this.meta)),this.storage.setItem(this.name,JSON.stringify(this.data)))},read:function(){if(this.storage)return this.meta=JSON.parse(this.storage.getItem(this.name+"_meta")),this.data=JSON.parse(this.storage.getItem(this.name))},clear:function(){this.storage&&(this.storage.removeItem(this.name+"_meta"),this.storage.removeItem(this.name));this.data=null},detail:function(a){return this.data[a]},readOrLoad:function(a,b,c){var d=this.read();null==d?this.request(a,b,c):c(d)},insert:function(a,b){var c=this,d=$.extend({},a);d.id&&delete d.id;this.request(this.getServerUrl("insert"),{data:d},function(a){d.id=a;c.data[d.id]=d;b&&b(d)})},deleteItems:function(a,b){var c=this;this.request(this.getServerUrl("delete"),{where:{id:a}},function(d){for(var e in a)delete c.data[a[e]];b&&b(a)})},update:function(a,b,c){var d=this,e=$.extend({},b);e.id&&delete e.id;this.request(this.getServerUrl("update"),{where:{id:a},data:e},function(e){b.id=a;d.data[a]=b;c&&c(b)})},search:function(a,b){a=a||{};this.filter&&$.extend(a,this.filter);this.lastFilter=a;var c=this;this.request(this.getServerUrl("search"),{where:a,pagesize:this.pagesize,page:this.page},function(a){b&&(c.data=c.changeDataIndex(a),b(a))})},pageTurn:function(a,b,c){var d=this.page+a;if(0>d)c("\u5df2\u7ecf\u662f\u7b2c\u4e00\u9875\u4e86");else{var e=this;this.request(this.getServerUrl("search"),{where:this.lastFilter,pagesize:this.pagesize,page:d},function(a){a.length?(e.data=e.changeDataIndex(a),e.page=d,b(a)):c("\u5df2\u7ecf\u662f\u6700\u540e\u4e00\u9875\u4e86")})}},pageTurnTo:function(a,b){var c=this;this.request(this.getServerUrl("search"),{where:this.lastFilter,pagesize:this.pagesize,page:this.page},function(a){b&&(c.data=c.changeDataIndex(a),b(a))})},statistics:function(a,b){this.request(this.getServerUrl("statistics"),{where:this.lastFilter,statistics:a},function(a){b&&b(a)})}};DataMagic.Model=Class.extend(DMListModel,{request:function(a,b,c){null!=a&&(DataMagic.ajaxSend(b),$.ajax({type:"get",url:a,async:!0,cache:!1,data:b,dataType:"jsonp",success:function(a,b,f){if(null==a||""===a)DataMagic.debug("\u670d\u52a1\u5668\u8fd4\u56de\u7684\u5185\u5bb9\u4e3a\u7a7a");else{try{if("error"===a.status){DataMagic.debug(a.reason);return}}catch(g){DataMagic.debug("\u89e3\u6790\u6570\u636e\u5931\u8d25:"+g)}c(a)}},complete:function(a,b){DataMagic.ajaxStop()}}))}});var DMListController={title:"\u57fa\u7840\u63a7\u5236\u5668",construct:function(a,b,c,d){DataMagic.Controller.instanceList.push(this);this.model=new DataMagic.Model(a,b,c,this,d);this.list=new DataMagic.View.List(this);this.toolbar=new DataMagic.View.Toolbar(this);this.form=new DataMagic.View.Form(this)},onDOMLoad:function(){DataMagic.debug("DOM\u52a0\u8f7d\u5b8c\u6210");this.list.initView($(".DMList"));this.toolbar.initView($(".DMToolbar"));this.form.initView($(".DMForm"));this.model.meta&&this.initViewWithMeta()},onMetaLoad:function(){DataMagic.debug("meta\u52a0\u8f7d\u5b8c\u6210");"interactive"!==document.readyState&&"complete"!==document.readyState||this.initViewWithMeta()},onDataLoad:function(){DataMagic.debug("data\u52a0\u8f7d\u5b8c\u6210");this.ready&&this.list.insert(this.model.data)},onReady:null,initViewWithMeta:function(){DataMagic.debug("\u5f00\u59cb\u521d\u59cb\u5316\u89c6\u56fe");this.ready=!0;DataMagic.initViewWithMeta(this.model.meta);this.list&&(this.list.clearAll(),this.model.data&&this.list.insert(this.model.data));this.toolbar.refresh(this.model.meta.tools);if(this.onReady)this.onReady()},execute:function(a,b){if(!b&&-1===this.toolbar.buttons.indexOf(a))return!1;if(this[a])this[a]();else DataMagic.debug(this),DataMagic.debug("\u8c03\u7528\u7684\u65b9\u6cd5\u4e0d\u5b58\u5728:"+a)},showForm:function(a,b){DataMagic.debug("\u663e\u793a\u8868\u5355");DataMagic.debug(b);this.form.mode=a;this.form.clearAll();if("insert"===a)for(var c in this.model.meta.fieldList){var d=this.model.meta.fieldList[c],d=d.dataType.createInputField(d.defaultValue);this.form.append(d)}else if("search"===a)for(c in this.model.meta.fieldList)d=this.model.meta.fieldList[c],d=d.dataType.createSearchField(),this.form.append(d);else for(c in this.model.meta.fieldList)d=this.model.meta.fieldList[c],d=d.dataType.createInputField(b[c]),this.form.append(d);this.form.show()},showFormForDetails:function(a){var b=this.list.getSelectedItems(!0);if(b){var c=this.list.getIDWithItems(b)[0],d=this.model.data[c];this.list.hide();"update"===a?this.toolbar.refresh(["save","cancel"]):this.toolbar.refresh(["cancel"]);this.showForm(a,d);this.currentID=c;this.currentItem=b}},getFormData:function(){var a="search"===this.form.mode?"getSearchParams":"getValue",b={},c=!0,d;for(d in this.model.meta.fieldList){var e=this.model.meta.fieldList[d],f=e.dataType[a]();f&&(b[d]=f);c=e.dataType.validated&&c}if(c)return b;DataMagic.dialog("\u60a8\u8f93\u5165\u7684\u6570\u636e\u683c\u5f0f\u4e0d\u6b63\u786e\uff01")},save:function(){var a=this.getFormData();if(null!=a){DataMagic.debug("\u83b7\u53d6\u8868\u5355\u7684\u503c");DataMagic.debug(a);delete a.id;var b=this;"insert"===this.form.mode?this.model.insert(a,function(a){b.list.insert(a)}):"update"===this.form.mode?(b=this,this.model.update(this.currentID,a,function(a){b.list.update(b.currentItem,a,b.model.meta.fieldList)})):"search"===this.form.mode&&this.model.search(a,function(a){b.list.clearAll();b.list.insert(a)});this.cancel()}},cancel:function(){this.toolbar.refresh(this.model.meta.tools);this.list.show();this.form.hide()},insert:function(){this.list.hide();this.showForm("insert");this.toolbar.refresh(["save","cancel"])},deleteItems:function(){var a=this.list.getSelectedItems(!0,!0);if(a){var b=this.list.getIDWithItems(a),c=this;this.model.deleteItems(b,function(){c.list.remove(a)})}},update:function(){this.showFormForDetails("update")},browse:function(){this.showFormForDetails("browse")},search:function(){this.list.hide();this.showForm("search");this.toolbar.refresh(["save","cancel"])},refresh:function(){var a=this;this.model.search(null,function(b){a.list.clearAll();a.list.insert(b)})},pageTurn:function(a){var b=this;this.model.pageTurn(a,function(a){b.list.clearAll();b.list.insert(a)},function(a){DataMagic.alert(a)})}};DataMagic.Controller=Class.extend(DMListController,{instanceList:[],onDOMLoad:function(){for(var a in DataMagic.Controller.instanceList)DataMagic.Controller.instanceList[a].onDOMLoad()}});$(DataMagic.Controller.onDOMLoad);var DMBaseView={title:"\u89c6\u56fe\u7c7b\u7684\u57fa\u7c7b",clearAll:function(){this.container.empty()},append:function(a){a.container||DataMagic.debug(a);this.container.append(a.container)},show:function(){this.container.show()},hide:function(){this.container.hide()}};DataMagic.View.Base=DataMagic.View.Abstract.extend(DMBaseView);var DMToolbarView={title:"\u5de5\u5177\u680f\u7c7b",executeEvent:"click",buttonPool:{},initView:function(a){this.container=a;var b=this;this.container.find(".DMButton").each(function(a,d){var c=$(d),f=c.data("command");b.buttonPool[f]=c}).remove()},refresh:function(a){this.buttons=a;this.container.find(".DMButton").remove();for(var b in a){var c=this,d=a[b];"delete"===d&&(d="deleteItems");d=this.buttonPool[d]?$(this.buttonPool[d]):this.buildButton(d);d.appendTo(this.container);d.on(this.executeEvent,function(){c.controller.execute($(this).data("command"))})}},buildButton:function(a){return $('\x3ca class\x3d"DMButton" data-command\x3d"'+a+'"\x3e\x3cspan\x3e'+a+"\x3c/span\x3e\x3c/a\x3e")}};DataMagic.View.Toolbar=DataMagic.View.Base.extend(DMToolbarView);var DMListView={title:"\u5217\u8868\u7c7b",initView:function(a){this.container=a;this.item=this.container.find(".DMItem").detach();0===this.item.length&&(this.item=this.buildItem());var b=this;this.item.click(function(a){b.onItemClick($(this))});this.item.dblclick(function(a){b.onItemDblclick($(this))})},onItemClick:function(a){a.toggleClass("selected")},onItemDblclick:function(a){this.container.find(".selected").removeClass("selected");a.addClass("selected");this.controller.execute("browse")},buildItem:function(){return $('\x3cli class\x3d"DMItem"\x3e\x3cdiv\x3e\x3cspan data-field\x3d"title"\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv style\x3d"font-size: 14px;color: gray;font-family: kaiti;"\x3e\x3cspan data-field\x3d"people"\x3e\x3c/span\x3e\x3cspan data-field\x3d"date"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/li\x3e')},clearAll:function(){this.container.find(".DMItem").remove()},getSelectedItems:function(a,b,c){var d=this.container.find(".DMItem.selected");return a&&0===d.length?(DataMagic.dialog(c||"\u81f3\u5c11\u9009\u62e9\u4e00\u6761\u6570\u636e"),!1):!b&&1<d.length?(d.removeClass("selected"),DataMagic.dialog(c||"\u53ea\u80fd\u9009\u62e9\u4e00\u6761\u6570\u636e"),!1):d},getIDWithItems:function(a){for(var b=[],c=0;c<a.length;c++){var d=a.eq(c).data("id");b.push(d)}return b},insert:function(a){a instanceof Array||(a=[a]);for(var b in a){var c=a[b],d=this.item.clone(!0);this.update(d,c,this.controller.model.meta.fieldList);d.data("id",c.id);this.container.append(d)}},update:function(a,b,c){a.find("[data-field]").each(function(){var a=$(this),e=a.data("field");b[e]&&(c[e]?a.html(c[e].dataType.tranToString(b[e])):a.html(b[e]))})},remove:function(a){a.remove()}};DataMagic.View.List=DataMagic.View.Base.extend(DMListView);DataMagic.View.Table=DataMagic.View.List.inherit("\u8868\u683c\u7c7b");var DMFormView={title:"\u8868\u5355\u7c7b",initView:function(a){this.container=a;this.container.hide()}};DataMagic.View.Form=DataMagic.View.Base.extend(DMFormView);var DMBaseField={title:"\u8f93\u5165\u6846\u7684\u57fa\u7c7b",buildField:function(a,b,c){return $("\x3cdiv\x3e"+this.buildInput(a,b,c)+"\x3c/div\x3e")},buildInput:function(a,b,c,d){return'\x3clabel for\x3d"'+a+'"\x3e'+b.title+'\x3c/label\x3e\x3cinput class\x3d"DMInput" type\x3d"text" id\x3d"'+a+'"/\x3e'},createField:function(a,b,c){this.container=this.buildField(a,b,c);this.input=this.container.find(".DMInput");this.listenInputChange(this.input);this.setValue(this.input,c)},listenInputChange:function(a){var b=this;a.change(function(){b.onInputChange($(this))});a.click(function(){b.onInputClick($(this))})},onInputChange:function(a){this.dataType.validationValue(this.getValue(a),a)},setValue:function(a,b){if(null!=b){var c=this.dataType.tranToString(b);a.val(c)}},getValue:function(a){a=a.val();return""===a||null===a?null:a},showMistake:function(a){a.removeClass("input-success");a.addClass("input-error")},hideMistake:function(a){a.removeClass("input-error");a.addClass("input-success")}};DataMagic.Field.Base=DataMagic.Field.Abstract.extend(DMBaseField);DataMagic.DataType.Base.prototype.inputField=DataMagic.Field.Base;function fill(){var a={id:1232,title:"\u6d4b\u8bd5-\u503c\u73ed",duty_content:"ergre",duty_userid:442124,people:"ergre",inputuserid:4241,inputusername:"ergre",date:"2017\u5e744\u67085\u65e5  8\u65f628\u5206",begin_time:"2017\u5e7410\u670810\u65e5",end_time:"2017\u5e7410\u670810\u65e5",visitor_name:"ergre",file_name:"ergre"},b;for(b in a){var c=$("[id\x3d"+b+"]");c.is("input")||c.is("textarea")?c.val(a[b]):c.text(a[b])}}DataMagic.initViewWithMeta=function(a){$(".DMTitle").html(a.describe)};DataMagic.View.Toolbar.prototype.buildButton=function(a){return $('\x3ca class\x3d"btn btn-default DMButton" data-command\x3d"'+a+'"\x3e\x3cspan\x3e'+a+"\x3c/span\x3e\x3c/a\x3e")};DataMagic.View.List.prototype.buildItem=function(){return $('\x3cli class\x3d"list-group-item DMItem"\x3e\x3c!--span class\x3d"badge"\x3e\u65b0\x3c/span\x3e--\x3e\x3cdiv\x3e\x3cspan data-field\x3d"title"\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv style\x3d"font-size: 14px;color: gray;font-family: kaiti;"\x3e\x3cspan data-field\x3d"people"\x3e\x3c/span\x3e\x3cspan data-field\x3d"date" class\x3d"pull-right"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/li\x3e')};DataMagic.Field.Base.prototype.buildField=function(a,b,c){return $('\x3cdiv class\x3d"form-group"\x3e'+this.buildInput(a,b,c)+'\x3cp class\x3d"help-block"\x3e'+(b.describe||"")+"\x3c/p\x3e\x3c/div\x3e")};DataMagic.Field.Base.prototype.buildInput=function(a,b,c,d){return'\x3clabel for\x3d"'+a+'"\x3e'+b.title+'\x3c/label\x3e\x3cinput class\x3d"form-control DMInput" type\x3d"text" id\x3d"'+a+'"/\x3e'};DataMagic.Field.Base.prototype.showMistake=function(a){a=a.parent();a.removeClass("has-success");a.addClass("has-error")};DataMagic.Field.Base.prototype.hideMistake=function(a){a=a.parent();a.removeClass("has-error");a.addClass("has-success")};var DMLongTextField={title:"\u957f\u6587\u672c\u8f93\u5165\u6846",buildInput:function(a,b,c,d){return'\x3clabel for\x3d"'+a+'"\x3e'+b.title+'\x3c/label\x3e\x3ctextarea id\x3d"'+a+'" class\x3d"form-control DMInput" rows\x3d"5"\x3e\x3c/textarea\x3e'}};DataMagic.Field.LongText=DataMagic.Field.Base.extend(DMLongTextField);DataMagic.DataType.LongText.prototype.inputField=DataMagic.Field.LongText;var DMNumberField={title:"\u6570\u5b57\u7c7b\u578b\u7684\u8f93\u5165\u6846",addon:{min:"\u6700\u5c0f",max:"\u6700\u5927"},buildSearchField:function(a,b,c){return $('\x3cdiv class\x3d"form-group"\x3e\x3cdiv\x3e'+this.buildInput(a,b,c,"min")+"\x3c/div\x3e\x3cdiv\x3e"+this.buildInput(a,b,c,"max")+'\x3c/div\x3e\x3cp class\x3d"help-block"\x3e'+(b.describe||"")+"\x3c/p\x3e\x3c/div\x3e")},buildInput:function(a,b,c,d){return d?(a=a+"-"+d,b='\x3clabel for\x3d"'+a+'"\x3e'+("min"===d?b.title:"")+"\x3c/label\x3e",b+='\x3cspan class\x3d"input-group-addon"\x3e'+this.addon[d]+"\x3c/span\x3e",b+('\x3cinput class\x3d"form-control DMInput" type\x3d"text" id\x3d"'+a+'"/\x3e')):DataMagic.Field.Base.prototype.buildInput(a,b,c)},createSearchField:function(a,b,c){this.container=this.buildSearchField(a,b,c);this.inputs=this.container.find(".DMInput");this.minInput=this.inputs.eq(0);this.maxInput=this.inputs.eq(1);this.listenInputChange(this.inputs)}};DataMagic.Field.Number=DataMagic.Field.Base.extend(DMNumberField);DataMagic.DataType.Number.prototype.inputField=DataMagic.Field.Number;$.fn.datetimepicker.dates["zh-CN"]={days:"\u661f\u671f\u65e5 \u661f\u671f\u4e00 \u661f\u671f\u4e8c \u661f\u671f\u4e09 \u661f\u671f\u56db \u661f\u671f\u4e94 \u661f\u671f\u516d \u661f\u671f\u65e5".split(" "),daysShort:"\u5468\u65e5 \u5468\u4e00 \u5468\u4e8c \u5468\u4e09 \u5468\u56db \u5468\u4e94 \u5468\u516d \u5468\u65e5".split(" "),daysMin:"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u65e5".split(""),months:"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),monthsShort:"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),today:"\u4eca\u5929",suffix:[],meridiem:["\u4e0a\u5348","\u4e0b\u5348"]};var DMDateField={title:"\u65e5\u671f\u7c7b\u578b\u8f93\u5165\u6846",addon:{min:"\u6700\u65e9",max:"\u6700\u665a"},option:{format:"yyyy\u5e74M\u6708d\u65e5",language:"zh-CN",weekStart:1,todayBtn:1,autoclose:1,todayHighlight:1,startView:4,minView:2,forceParse:0},listenInputChange:function(a){var b=this;a.change(function(){b.onInputChange($(this))});console.log(this);a.datetimepicker(this.option)}};DataMagic.Field.Date=DataMagic.Field.Number.extend(DMDateField);DataMagic.DataType.Date.prototype.inputField=DataMagic.Field.Date;var DMDateTimeField={title:"\u65f6\u95f4\u65e5\u671f\u7c7b\u578b\u8f93\u5165\u6846",option:{format:"yyyy\u5e74M\u6708d\u65e5  H\u65f6i\u5206",language:"zh-CN",weekStart:1,todayBtn:1,autoclose:1,todayHighlight:1,startView:4,minView:0,forceParse:0,minuteStep:1}};DataMagic.Field.DateTime=DataMagic.Field.Date.extend(DMDateTimeField);DataMagic.DataType.DateTime.prototype.inputField=DataMagic.Field.DateTime;var DMSelectField={title:"\u5355\u9009\u7c7b\u578b\u7684\u8f93\u5165\u6846",construct:function(a){this.dataType=a;this.options=this.dataType.options},buildInput:function(a,b,c){a='\x3clabel for\x3d"'+a+'"\x3e'+b.title+'\x3c/label\x3e\x3cdiv class\x3d"btn-group DMInput" id\x3d"'+a+'"\x3e';for(var d in this.options)a+='\x3ca class\x3d"btn btn-default" data-value\x3d"'+d+'"\x3e\x3cspan\x3e'+this.options[d]+"\x3c/span\x3e\x3c/a\x3e";return a+"\x3c/div\x3e"},listenInputChange:function(a){var b=this;this.items=this.container.find(".btn").click(function(){b.onselect($(this))});a.change(function(){b.onInputChange($(this))});a.click(function(){b.onInputClick($(this))})},createSearchField:function(a,b,c){this.options[-1]=this.dataType.any;this.createField(a,b,c);delete this.options[-1]},onselect:function(a){this.items.removeClass("selected");a.addClass("selected")},setValue:function(a,b){this.items.removeClass("selected");null!=b&&this.items.filter("[data-value\x3d"+b+"]").addClass("selected")},getValue:function(a){a=a.find(".selected");return a.length?a.eq(0).text():null}};DataMagic.Field.Select=DataMagic.Field.Base.extend(DMSelectField);DataMagic.DataType.Select.prototype.inputField=DataMagic.Field.Select;var DMMultipleField={title:"\u591a\u9009\u7c7b\u578b\u7684\u8f93\u5165\u6846",onselect:function(a){a.toggleClass("selected")},setValue:function(a,b){this.items.removeClass("selected");if(null!=b){var c=b.split(","),d;for(d in c)this.items.filter("[data-value\x3d"+b[d]+"]").addClass("selected")}},getValue:function(a){a=a.find(".selected");for(var b=[],c=0;c<a.length;c++)b.push(a.eq(c).text());return a.length?b.join(","):null}};DataMagic.Field.Multiple=DataMagic.Field.Select.extend(DMMultipleField);DataMagic.DataType.Multiple.prototype.inputField=DataMagic.Field.Multiple;